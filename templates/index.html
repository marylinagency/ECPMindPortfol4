{% extends "base.html" %}

{% block content %}
<div class="container-desktop py-8">
    {% if show_license %}
        <!-- License Activation Section -->
        <div class="min-h-screen flex items-center justify-center">
            <div class="max-w-md w-full">
                <div class="bg-white rounded-xl shadow-2xl p-8 glass-morphism fade-in">
                    <div class="text-center mb-8">
                        <div class="w-16 h-16 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-4 pulse-glow">
                            <i data-feather="key" class="w-8 h-8 text-white"></i>
                        </div>
                        <h2 class="text-2xl font-bold text-gray-900 mb-2">Activate BookGenPro</h2>
                        <p class="text-gray-600">Enter your license key to get started</p>
                    </div>
                    
                    <form method="POST" action="{{ url_for('activate_license') }}" data-validate>
                        <div class="space-y-6">
                            <div>
                                <label for="license_key" class="block text-sm font-medium text-gray-700 mb-2">License Key</label>
                                <input type="text" id="license_key" name="license_key" required
                                       class="w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                                       placeholder="Enter your license key">
                            </div>
                            
                            <div>
                                <label for="email" class="block text-sm font-medium text-gray-700 mb-2">Email Address</label>
                                <input type="email" id="email" name="email" required
                                       class="w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                                       placeholder="Enter your email address">
                            </div>
                            
                            <div class="bg-gray-50 border border-gray-200 rounded-lg p-3">
                                <div class="flex items-center text-sm text-gray-600">
                                    <i data-feather="shield" class="w-4 h-4 mr-2"></i>
                                    <span>Machine ID: <span class="font-mono text-xs">{{ config.machine_id }}</span></span>
                                </div>
                                <p class="text-xs text-gray-500 mt-1">Automatically generated for this device</p>
                            </div>
                            
                            <button type="submit" 
                                    class="w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white py-3 rounded-lg hover:shadow-lg transform hover:scale-105 transition-all duration-200 font-medium">
                                <i data-feather="unlock" class="w-5 h-5 inline mr-2"></i>
                                Activate License
                            </button>
                        </div>
                    </form>
                    
                    <div class="mt-8 pt-6 border-t border-gray-200 text-center">
                        <p class="text-sm text-gray-600">
                            Need a license? Visit 
                            <a href="https://www.ecertifpro.com" target="_blank" class="text-blue-600 hover:text-blue-800 font-medium">ECertifPro.com</a>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    {% else %}
        <!-- Main Dashboard -->
        <div class="min-h-screen flex flex-col justify-center fade-in">
            <!-- Hero Section -->
            <div class="hero-section enhanced-hero-section text-center mb-16">
                <div class="floating-icons">
                    <div class="floating-icon" style="top: 10%; left: 15%;">ðŸ“š</div>
                    <div class="floating-icon" style="top: 20%; right: 20%; animation-delay: 1s;">âœ¨</div>
                    <div class="floating-icon" style="top: 60%; left: 10%; animation-delay: 2s;">ðŸš€</div>
                    <div class="floating-icon" style="top: 70%; right: 15%; animation-delay: 3s;">ðŸ’¡</div>
                    <div class="floating-icon" style="top: 30%; left: 50%; animation-delay: 1.5s;">ðŸ“–</div>
                </div>
                <div class="title-container">
                    <div class="particle-overlay" id="title-particles"></div>
                    <h1 class="enhanced-title title-glow-effect text-6xl md:text-8xl mb-8">
                        BookGenPro
                    </h1>
                </div>
                <div class="enhanced-subtitle text-2xl md:text-3xl mb-8 mx-auto max-w-5xl leading-relaxed">
                    <span class="word-animation">Transform</span>
                    <span class="word-animation">your</span>
                    <span class="word-animation">ideas</span>
                    <span class="word-animation">into</span>
                    <span class="word-animation">complete</span>
                    <span class="word-animation">books</span>
                    <span class="word-animation">with</span>
                    <span class="word-animation">AI-powered</span>
                    <span class="word-animation">generation</span>
                </div>
            </div>
            
            <!-- Centered AI Book Generation Card -->
            <div class="flex justify-center">
                <div class="ai-book-card p-12 max-w-4xl w-full"
                     onmouseenter="createSparkles(this)"
                     onmouseleave="removeSparkles(this)">
                    
                    <div class="text-center mb-8">
                        <div class="w-20 h-20 bg-gradient-to-br from-orange-500 to-red-600 rounded-full flex items-center justify-center mx-auto mb-6 shadow-2xl">
                            <i data-feather="zap" class="w-10 h-10 text-white"></i>
                        </div>
                        <h2 class="text-4xl font-bold text-white mb-4">AI Book Generation</h2>
                        <p class="text-lg text-gray-200 max-w-2xl mx-auto">
                            Let our advanced AI create a complete book for you. Just provide a topic and watch magic happen.
                        </p>
                    </div>
                    
                    <form method="POST" action="{{ url_for('create_ai_book') }}" class="space-y-6" id="generate-book-form">
                        <div class="mb-8">
                            <label for="gen_topic" class="block text-lg font-semibold text-white mb-4 text-center">What's Your Book About?</label>
                            <textarea id="gen_topic" name="topic" rows="4" required
                                      class="w-full px-6 py-4 bg-white/90 backdrop-blur border-0 rounded-2xl text-lg focus:ring-4 focus:ring-orange-300 focus:outline-none shadow-xl transition-all duration-300"
                                      placeholder="Describe your book topic, genre, target audience, and key themes you want covered..."></textarea>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                            <div>
                                <label for="gen_language" class="block text-sm font-semibold text-white mb-3">Language</label>
                                <select id="gen_language" name="language" class="w-full px-4 py-3 bg-white/90 backdrop-blur border-0 rounded-xl focus:ring-4 focus:ring-orange-300 focus:outline-none shadow-lg transition-all duration-300">
                                    <option value="English">English</option>
                                    <option value="Spanish">Spanish</option>
                                    <option value="French">French</option>
                                    <option value="German">German</option>
                                    <option value="Italian">Italian</option>
                                    <option value="Portuguese">Portuguese</option>
                                    <option value="Arabic">Arabic</option>
                                    <option value="Chinese">Chinese</option>
                                    <option value="Japanese">Japanese</option>
                                </select>
                            </div>
                            
                            <div>
                                <label for="gen_chapters" class="block text-sm font-semibold text-white mb-3">Chapters</label>
                                <input type="number" id="gen_chapters" name="chapters" value="8" min="3" max="25"
                                       class="w-full px-4 py-3 bg-white/90 backdrop-blur border-0 rounded-xl focus:ring-4 focus:ring-orange-300 focus:outline-none shadow-lg transition-all duration-300">
                            </div>
                            
                            <div>
                                <label for="gen_style" class="block text-sm font-semibold text-white mb-3">Writing Style</label>
                                <select id="gen_style" name="style" class="w-full px-4 py-3 bg-white/90 backdrop-blur border-0 rounded-xl focus:ring-4 focus:ring-orange-300 focus:outline-none shadow-lg transition-all duration-300">
                                    <option value="professional">Professional</option>
                                    <option value="casual">Casual</option>
                                    <option value="academic">Academic</option>
                                    <option value="creative">Creative</option>
                                    <option value="technical">Technical</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="bg-white/20 backdrop-blur border border-white/30 rounded-2xl p-6 mb-8">
                            <div class="flex items-start space-x-4">
                                <div class="w-8 h-8 bg-white/30 rounded-full flex items-center justify-center">
                                    <i data-feather="info" class="w-4 h-4 text-white"></i>
                                </div>
                                <div>
                                    <h4 class="font-semibold text-white mb-3">How It Works</h4>
                                    <ul class="text-sm text-gray-100 space-y-2">
                                        <li class="flex items-center"><span class="w-2 h-2 bg-orange-400 rounded-full mr-3"></span>AI analyzes your topic and creates chapter outlines</li>
                                        <li class="flex items-center"><span class="w-2 h-2 bg-orange-400 rounded-full mr-3"></span>Content is generated chapter by chapter automatically</li>
                                        <li class="flex items-center"><span class="w-2 h-2 bg-orange-400 rounded-full mr-3"></span>Monitor progress and edit content in real-time</li>
                                        <li class="flex items-center"><span class="w-2 h-2 bg-orange-400 rounded-full mr-3"></span>Typically takes 2-5 minutes per chapter</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <div class="flex flex-col sm:flex-row gap-6">
                            <button type="submit" name="action" value="generate_titles"
                                    class="generate-btn flex-1 flex items-center justify-center space-x-3 text-lg py-4">
                                <i data-feather="list" class="w-6 h-6"></i>
                                <span>Generate Chapter Titles</span>
                            </button>
                            
                            <button type="submit" name="action" value="generate_full"
                                    class="generate-btn flex-1 flex items-center justify-center space-x-3 text-lg py-4 bg-gradient-to-r from-red-600 to-pink-600">
                                <i data-feather="book" class="w-6 h-6"></i>
                                <span>Generate Full Book</span>
                            </button>
                        </div>
                    </form>
                    
                    <!-- Generation Status -->
                    <div id="generation-status" class="mt-8 hidden">
                        <div class="bg-white/30 backdrop-blur border border-white/40 rounded-2xl p-6">
                            <div class="flex items-center justify-between mb-4">
                                <h4 class="font-semibold text-white">Generation Progress</h4>
                                <span id="progress-text" class="text-sm text-gray-200">Initializing...</span>
                            </div>
                            
                            <div class="w-full bg-white/20 rounded-full h-3 mb-4">
                                <div id="progress-bar" class="bg-gradient-to-r from-orange-400 to-red-500 h-3 rounded-full transition-all duration-500" style="width: 0%"></div>
                            </div>
                            
                            <div id="current-chapter" class="text-sm text-gray-200"></div>
                        </div>
                        
                        <div class="mt-6 flex justify-center">
                            <button onclick="stopGeneration()" class="bg-red-600/80 backdrop-blur text-white px-6 py-3 rounded-xl hover:bg-red-700 transition-all duration-300 border border-red-500/50">
                                <i data-feather="stop-circle" class="w-4 h-4 inline mr-2"></i>
                                Stop Generation
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Secondary Actions Section -->
            <div class="mt-16 grid md:grid-cols-2 gap-8">
                <!-- Quick Generation Templates -->
                <div class="bg-white/10 backdrop-blur border border-white/20 rounded-2xl p-8">
                    <h3 class="text-2xl font-bold text-white mb-6 text-center">Quick Templates</h3>
                    <div class="grid grid-cols-2 gap-4">
                        <button class="bg-white/20 backdrop-blur border border-white/30 rounded-xl p-4 text-white hover:bg-white/30 transition-all duration-300" onclick="fillTemplate('business')">
                            <i data-feather="briefcase" class="w-6 h-6 mx-auto mb-2"></i>
                            <div class="text-sm font-medium">Business</div>
                        </button>
                        
                        <button class="bg-white/20 backdrop-blur border border-white/30 rounded-xl p-4 text-white hover:bg-white/30 transition-all duration-300" onclick="fillTemplate('tech')">
                            <i data-feather="code" class="w-6 h-6 mx-auto mb-2"></i>
                            <div class="text-sm font-medium">Tech</div>
                        </button>
                        
                        <button class="bg-white/20 backdrop-blur border border-white/30 rounded-xl p-4 text-white hover:bg-white/30 transition-all duration-300" onclick="fillTemplate('fiction')">
                            <i data-feather="feather" class="w-6 h-6 mx-auto mb-2"></i>
                            <div class="text-sm font-medium">Fiction</div>
                        </button>
                        
                        <button class="bg-white/20 backdrop-blur border border-white/30 rounded-xl p-4 text-white hover:bg-white/30 transition-all duration-300" onclick="fillTemplate('educational')">
                            <i data-feather="book-open" class="w-6 h-6 mx-auto mb-2"></i>
                            <div class="text-sm font-medium">Education</div>
                        </button>
                    </div>
                </div>
                
                <!-- Manual Project Creation -->
                <div class="bg-white/10 backdrop-blur border border-white/20 rounded-2xl p-8">
                    <h3 class="text-2xl font-bold text-white mb-6 text-center">Manual Creation</h3>
                    <p class="text-gray-300 text-center mb-6">Want more control? Create a project manually and add your own chapters.</p>
                    <div class="text-center">
                        <button onclick="showManualForm()" 
                               class="inline-flex items-center justify-center space-x-3 bg-white/20 backdrop-blur text-white px-8 py-4 rounded-xl hover:bg-white/30 transition-all duration-300 border border-white/30">
                            <i data-feather="edit" class="w-5 h-5"></i>
                            <span>Create Manual Project</span>
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="grid md:grid-cols-2 gap-8 mb-12">
                <!-- API Configuration -->
                <div class="bg-white rounded-xl shadow-lg p-8 card-interactive scroll-reveal">
                    <div class="flex items-center mb-6">
                        <div class="w-12 h-12 bg-gradient-to-br from-purple-500 to-pink-600 rounded-lg flex items-center justify-center mr-4">
                            <i data-feather="settings" class="w-6 h-6 text-white"></i>
                        </div>
                        <h3 class="text-2xl font-bold text-gray-900">Configuration</h3>
                    </div>
                    
                    <div class="space-y-4">
                        <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                            <div>
                                <h4 class="font-medium text-gray-900">OpenRouter API</h4>
                                <p class="text-sm text-gray-600">
                                    {% if config.openrouter_api_key %}
                                        <span class="text-green-600">âœ“ Configured</span>
                                    {% else %}
                                        <span class="text-red-600">âœ— Not configured</span>
                                    {% endif %}
                                </p>
                            </div>
                            <a href="{{ url_for('settings') }}" 
                               class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                                Configure
                            </a>
                        </div>
                        
                        <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                            <div>
                                <h4 class="font-medium text-gray-900">Selected Model</h4>
                                <p class="text-sm text-gray-600">{{ config.selected_model or 'Not selected' }}</p>
                            </div>
                            <a href="{{ url_for('settings') }}" 
                               class="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors">
                                Change
                            </a>
                        </div>
                        
                        <div class="mt-6 p-4 bg-blue-50 rounded-lg">
                            <h4 class="font-medium text-blue-900 mb-2">Features Available</h4>
                            <ul class="text-sm text-blue-800 space-y-1">
                                <li class="flex items-center"><i data-feather="check" class="w-4 h-4 mr-2"></i>AI Chapter Generation</li>
                                <li class="flex items-center"><i data-feather="check" class="w-4 h-4 mr-2"></i>Multi-language Support</li>
                                <li class="flex items-center"><i data-feather="check" class="w-4 h-4 mr-2"></i>PDF & HTML Export</li>
                                <li class="flex items-center"><i data-feather="check" class="w-4 h-4 mr-2"></i>Project Management</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Recent Projects -->
            {% if recent_projects %}
            <div class="mb-12">
                <h2 class="text-3xl font-bold text-gray-900 mb-8">Recent Projects</h2>
                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                    {% for project in recent_projects %}
                    <div class="bg-white rounded-lg shadow-lg overflow-hidden card-interactive scroll-reveal tooltip-dynamic" data-tooltip="Click to open project">
                        {% if project.cover_image %}
                            <div class="h-48 bg-cover bg-center book-cover" 
                                 style="background-image: url('{{ url_for('static', filename='../uploads/' + project.cover_image) }}');">
                            </div>
                        {% else %}
                            <div class="h-48 book-cover flex items-center justify-center">
                                <i data-feather="book" class="w-16 h-16 text-white opacity-80"></i>
                            </div>
                        {% endif %}
                        
                        <div class="p-6">
                            <h3 class="text-xl font-bold text-gray-900 mb-2">{{ project.name }}</h3>
                            <p class="text-gray-600 mb-4 line-clamp-2">{{ project.topic }}</p>
                            
                            <div class="flex items-center justify-between text-sm text-gray-500 mb-4">
                                <span>{{ project.chapters|length }} chapters</span>
                                <span>{{ project.language }}</span>
                            </div>
                            
                            <a href="{{ url_for('project_view', project_id=project.id) }}" 
                               class="w-full btn-dynamic text-white py-2 px-4 rounded-lg text-center block">
                                <i data-feather="arrow-right" class="w-4 h-4 inline mr-2"></i>
                                Open Project
                            </a>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endif %}
            
            <!-- About Section -->
            <div class="bg-white rounded-xl shadow-lg p-8 mb-12 card-interactive scroll-reveal">
                <div class="text-center">
                    <h2 class="text-3xl font-bold text-gray-900 mb-6 text-shimmer">About BookGenPro</h2>
                    <div class="max-w-4xl mx-auto">
                        <p class="text-lg text-gray-600 mb-8">
                            BookGenPro is an innovative AI-powered book generation tool that transforms your ideas into 
                            complete, professionally structured books. Using advanced AI technology through OpenRouter API, 
                            it automatically generates compelling chapter titles and rich content based on your book's theme.
                        </p>
                        
                        <div class="grid md:grid-cols-3 gap-8 mb-8">
                            <div class="text-center">
                                <div class="w-16 h-16 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-4">
                                    <i data-feather="zap" class="w-8 h-8 text-white"></i>
                                </div>
                                <h3 class="text-xl font-semibold text-gray-900 mb-2">AI-Powered</h3>
                                <p class="text-gray-600">Advanced AI generates chapter titles and content automatically</p>
                            </div>
                            
                            <div class="text-center">
                                <div class="w-16 h-16 bg-gradient-to-br from-green-500 to-blue-600 rounded-full flex items-center justify-center mx-auto mb-4">
                                    <i data-feather="globe" class="w-8 h-8 text-white"></i>
                                </div>
                                <h3 class="text-xl font-semibold text-gray-900 mb-2">Multi-Language</h3>
                                <p class="text-gray-600">Generate books in multiple languages with native fluency</p>
                            </div>
                            
                            <div class="text-center">
                                <div class="w-16 h-16 bg-gradient-to-br from-purple-500 to-pink-600 rounded-full flex items-center justify-center mx-auto mb-4">
                                    <i data-feather="download" class="w-8 h-8 text-white"></i>
                                </div>
                                <h3 class="text-xl font-semibold text-gray-900 mb-2">Professional Export</h3>
                                <p class="text-gray-600">Export to PDF and HTML with beautiful, professional styling</p>
                            </div>
                        </div>
                        
                        <div class="border-t border-gray-200 pt-8">
                            <p class="text-gray-600 mb-4">
                                Developed with passion by the ECPMind team, BookGenPro represents the cutting edge of 
                                AI-assisted content creation, making professional book writing accessible to everyone.
                            </p>
                            <a href="https://www.ecertifpro.com" target="_blank" 
                               class="inline-flex items-center text-blue-600 hover:text-blue-800 font-semibold">
                                <i data-feather="external-link" class="w-4 h-4 mr-2"></i>
                                Learn more at ECertifPro.com
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Floating Action Button -->
        <button class="fab tooltip-dynamic" data-tooltip="Quick actions" onclick="showQuickActions()">
            <i data-feather="plus" class="w-6 h-6"></i>
        </button>
        
        <!-- Dynamic loading overlay -->
        <div id="loading-overlay" class="fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm hidden items-center justify-center z-50">
            <div class="bg-white rounded-lg p-8 text-center">
                <div class="animate-spin w-12 h-12 border-4 border-blue-500 border-t-transparent rounded-full mx-auto mb-4"></div>
                <p class="text-gray-700 font-medium">Processing your request...</p>
            </div>
        </div>
    {% endif %}
</div>

<!-- Real-time notifications container -->
<div id="notifications-container" class="fixed top-4 right-4 z-50 space-y-2"></div>

<!-- Dynamic status bar -->
<div id="status-bar" class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 px-4 py-2 text-sm text-gray-600 hidden">
    <div class="flex items-center justify-between">
        <span id="status-text">Ready</span>
        <div class="flex items-center space-x-4">
            <span id="connection-status" class="status-indicator status-completed">Online</span>
            <button onclick="toggleStatusBar()" class="text-gray-400 hover:text-gray-600">
                <i data-feather="x" class="w-4 h-4"></i>
            </button>
        </div>
    </div>
</div>
{% endblock %}
