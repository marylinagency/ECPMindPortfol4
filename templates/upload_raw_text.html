{% extends "base.html" %}

{% block title %}Format Raw Text for KDP Publishing{% endblock %}

{% block content %}
<div class="min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50">
    <div class="container mx-auto px-4 py-8">
        <!-- Header Section -->
        <div class="text-center mb-12">
            <div class="inline-flex items-center justify-center w-20 h-20 bg-gradient-to-r from-orange-500 to-red-500 rounded-full mb-6">
                <i data-feather="edit-3" class="w-10 h-10 text-white"></i>
            </div>
            <h1 class="text-4xl font-bold text-gray-900 mb-4">Professional Book Formatter</h1>
            <p class="text-xl text-gray-600 max-w-3xl mx-auto">
                Transform your raw text or poorly formatted content into a professional, 
                Amazon KDP print-ready book with proper formatting, margins, and typography.
            </p>
        </div>

        <!-- Features Overview -->
        <div class="bg-white rounded-xl shadow-lg p-8 mb-8">
            <h2 class="text-2xl font-bold text-gray-900 mb-6 text-center">What This Tool Does</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <div class="text-center">
                    <div class="w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center mx-auto mb-3">
                        <i data-feather="layout" class="w-6 h-6 text-orange-600"></i>
                    </div>
                    <h3 class="font-semibold text-gray-900 mb-2">6x9 Inch Format</h3>
                    <p class="text-sm text-gray-600">Standard Amazon KDP paperback trim size</p>
                </div>
                <div class="text-center">
                    <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center mx-auto mb-3">
                        <i data-feather="align-justify" class="w-6 h-6 text-blue-600"></i>
                    </div>
                    <h3 class="font-semibold text-gray-900 mb-2">Professional Margins</h3>
                    <p class="text-sm text-gray-600">Optimized for binding with proper gutters</p>
                </div>
                <div class="text-center">
                    <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center mx-auto mb-3">
                        <i data-feather="type" class="w-6 h-6 text-green-600"></i>
                    </div>
                    <h3 class="font-semibold text-gray-900 mb-2">Garamond Typography</h3>
                    <p class="text-sm text-gray-600">Professional book font, 12pt justified text</p>
                </div>
                <div class="text-center">
                    <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center mx-auto mb-3">
                        <i data-feather="printer" class="w-6 h-6 text-purple-600"></i>
                    </div>
                    <h3 class="font-semibold text-gray-900 mb-2">Print-Ready PDF</h3>
                    <p class="text-sm text-gray-600">No watermarks, perfect for KDP submission</p>
                </div>
            </div>
        </div>

        <!-- Upload Form -->
        <div class="bg-white rounded-xl shadow-lg p-8">
            <form method="POST" action="{{ url_for('upload_raw_text') }}" class="space-y-6">
                <!-- Project Name -->
                <div>
                    <label for="project_name" class="block text-sm font-medium text-gray-700 mb-2">
                        <i data-feather="book" class="w-4 h-4 inline mr-1"></i>
                        Book Title *
                    </label>
                    <input type="text" 
                           id="project_name" 
                           name="project_name" 
                           required
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                           placeholder="Enter your book title">
                </div>

                <!-- Author Name -->
                <div>
                    <label for="author_name" class="block text-sm font-medium text-gray-700 mb-2">
                        <i data-feather="user" class="w-4 h-4 inline mr-1"></i>
                        Author Name
                    </label>
                    <input type="text" 
                           id="author_name" 
                           name="author_name" 
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                           placeholder="Enter author name (optional)">
                </div>

                <!-- Raw Content -->
                <div>
                    <label for="raw_content" class="block text-sm font-medium text-gray-700 mb-2">
                        <i data-feather="edit-3" class="w-4 h-4 inline mr-1"></i>
                        Raw Text Content *
                    </label>
                    <div class="mb-3 p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
                        <h4 class="font-medium text-yellow-800 mb-2">Supported Formats:</h4>
                        <ul class="text-sm text-yellow-700 space-y-1">
                            <li>• Text with "Chapter 1:", "Chapter 2:" markers</li>
                            <li>• Text with "CHAPTER 1", "CHAPTER 2" headers</li>
                            <li>• Numbered sections like "1. Title", "2. Title"</li>
                            <li>• Plain text (will be automatically divided into chapters)</li>
                            <li>• Poorly formatted content with excessive whitespace</li>
                        </ul>
                    </div>
                    <textarea id="raw_content" 
                              name="raw_content" 
                              required
                              rows="15"
                              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 font-mono text-sm"
                              placeholder="Paste your raw book content here...

Example:
Chapter 1: Introduction
Welcome to this amazing book about...

Chapter 2: Getting Started
In this chapter, we will explore..."></textarea>
                </div>

                <!-- Format Options -->
                <div class="bg-gray-50 rounded-lg p-4">
                    <h3 class="font-semibold text-gray-900 mb-3">
                        <i data-feather="settings" class="w-4 h-4 inline mr-1"></i>
                        Professional Formatting Applied
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                        <div class="space-y-2">
                            <div class="flex items-center text-gray-600">
                                <i data-feather="check" class="w-4 h-4 text-green-500 mr-2"></i>
                                <span>Trim Size: 6 x 9 inches</span>
                            </div>
                            <div class="flex items-center text-gray-600">
                                <i data-feather="check" class="w-4 h-4 text-green-500 mr-2"></i>
                                <span>Inside Margin: 0.75 inches</span>
                            </div>
                            <div class="flex items-center text-gray-600">
                                <i data-feather="check" class="w-4 h-4 text-green-500 mr-2"></i>
                                <span>Outside Margin: 0.5 inches</span>
                            </div>
                        </div>
                        <div class="space-y-2">
                            <div class="flex items-center text-gray-600">
                                <i data-feather="check" class="w-4 h-4 text-green-500 mr-2"></i>
                                <span>Font: EB Garamond, 12pt</span>
                            </div>
                            <div class="flex items-center text-gray-600">
                                <i data-feather="check" class="w-4 h-4 text-green-500 mr-2"></i>
                                <span>Justified text with hyphenation</span>
                            </div>
                            <div class="flex items-center text-gray-600">
                                <i data-feather="check" class="w-4 h-4 text-green-500 mr-2"></i>
                                <span>Professional chapter formatting</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Submit Button -->
                <div class="flex flex-col sm:flex-row gap-4 pt-6">
                    <button type="submit" 
                            class="flex-1 bg-gradient-to-r from-orange-600 to-red-600 text-white px-8 py-4 rounded-lg hover:shadow-lg transform hover:scale-105 transition-all duration-200 font-medium">
                        <i data-feather="upload" class="w-5 h-5 inline mr-2"></i>
                        Process & Format for KDP Publishing
                    </button>
                    <a href="{{ url_for('index') }}" 
                       class="flex-shrink-0 bg-gray-500 hover:bg-gray-600 text-white px-6 py-4 rounded-lg transition-colors font-medium text-center">
                        <i data-feather="arrow-left" class="w-5 h-5 inline mr-2"></i>
                        Back to Dashboard
                    </a>
                </div>
            </form>
        </div>

        <!-- Help Section -->
        <div class="mt-8 bg-blue-50 rounded-xl p-6">
            <h3 class="text-lg font-semibold text-blue-900 mb-3">
                <i data-feather="help-circle" class="w-5 h-5 inline mr-2"></i>
                How It Works
            </h3>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-blue-800">
                <div>
                    <h4 class="font-medium mb-2">1. Upload Content</h4>
                    <p>Paste your raw text, poorly formatted document, or content with basic chapter markers.</p>
                </div>
                <div>
                    <h4 class="font-medium mb-2">2. Automatic Processing</h4>
                    <p>The system intelligently detects chapters, cleans formatting, and optimizes paragraph structure.</p>
                </div>
                <div>
                    <h4 class="font-medium mb-2">3. KDP-Ready Export</h4>
                    <p>Download a professional PDF with Amazon KDP specifications - ready for publishing!</p>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// Character counter for textarea
document.getElementById('raw_content').addEventListener('input', function() {
    const textarea = this;
    const charCount = textarea.value.length;
    
    // Add visual feedback for content length
    if (charCount > 10000) {
        textarea.classList.add('border-green-500');
        textarea.classList.remove('border-yellow-500', 'border-red-500');
    } else if (charCount > 1000) {
        textarea.classList.add('border-yellow-500');
        textarea.classList.remove('border-green-500', 'border-red-500');
    } else {
        textarea.classList.add('border-red-500');
        textarea.classList.remove('border-green-500', 'border-yellow-500');
    }
});

// Form validation
document.querySelector('form').addEventListener('submit', function(e) {
    const projectName = document.getElementById('project_name').value.trim();
    const rawContent = document.getElementById('raw_content').value.trim();
    
    if (!projectName || !rawContent) {
        e.preventDefault();
        alert('Please fill in both the book title and content before submitting.');
        return false;
    }
    
    if (rawContent.length < 500) {
        e.preventDefault();
        if (!confirm('Your content seems quite short (less than 500 characters). Are you sure you want to continue?')) {
            return false;
        }
    }
    
    // Show loading state
    const submitBtn = this.querySelector('button[type="submit"]');
    submitBtn.innerHTML = '<i data-feather="loader" class="w-5 h-5 inline mr-2 animate-spin"></i>Processing...';
    submitBtn.disabled = true;
});
</script>
{% endblock %}